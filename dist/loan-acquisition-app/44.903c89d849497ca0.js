"use strict";(self.webpackChunkdemo=self.webpackChunkdemo||[]).push([[44],{8044:(w,m,s)=>{s.r(m),s.d(m,{LoanReviewComponent:()=>b});var c=s(177),a=s(4341),u=s(8261),p=s(223),t=s(4438),d=s(7681),_=s(1369),v=s(8010);function E(i,r){if(1&i&&(t.j41(0,"div",18)(1,"div",19)(2,"div"),t.nrm(3,"i",20),t.EFF(4),t.k0s(),t.j41(5,"button",21),t.nrm(6,"i",22),t.EFF(7," Download "),t.k0s()()()),2&i){const e=r.$implicit;t.R7$(4),t.SpI(" ",e.name," ")}}function F(i,r){1&i&&(t.j41(0,"div",23),t.EFF(1," No documents uploaded "),t.k0s())}function g(i,r){if(1&i&&(t.j41(0,"div",18)(1,"div",24)(2,"strong"),t.EFF(3),t.k0s(),t.j41(4,"small"),t.EFF(5),t.nI1(6,"date"),t.k0s()(),t.j41(7,"p",25),t.EFF(8),t.k0s()()),2&i){const e=r.$implicit;t.R7$(3),t.JRh(e.author),t.R7$(2),t.JRh(t.i5U(6,3,e.createdAt,"short")),t.R7$(3),t.JRh(e.text)}}function R(i,r){if(1&i){const e=t.RV6();t.j41(0,"form",26),t.bIt("ngSubmit",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.onSubmit())}),t.j41(1,"div",27)(2,"label",28),t.EFF(3,"Review Comment"),t.k0s(),t.nrm(4,"textarea",29),t.k0s(),t.j41(5,"div",30)(6,"button",31),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.updateStatus(o.LoanStatus.APPROVED))}),t.EFF(7," Approve "),t.k0s(),t.j41(8,"button",32),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.updateStatus(o.LoanStatus.REJECTED))}),t.EFF(9," Reject "),t.k0s(),t.j41(10,"button",33),t.bIt("click",function(){t.eBV(e);const o=t.XpG(2);return t.Njj(o.updateStatus(o.LoanStatus.PENDING_DOCUMENTS))}),t.EFF(11," Request Documents "),t.k0s()()()}if(2&i){const e=t.XpG(2);t.Y8G("formGroup",e.reviewForm)}}function f(i,r){if(1&i&&(t.j41(0,"div",34),t.nrm(1,"div",35),t.j41(2,"div",36)(3,"h6"),t.EFF(4),t.k0s(),t.j41(5,"p"),t.EFF(6),t.k0s(),t.j41(7,"small"),t.EFF(8),t.nI1(9,"date"),t.k0s()()()),2&i){const e=r.$implicit;t.R7$(4),t.JRh(e.status),t.R7$(2),t.JRh(e.comment),t.R7$(2),t.Lme("",t.i5U(9,4,e.date,"short")," - ",e.user,"")}}function h(i,r){if(1&i&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"h3"),t.EFF(6),t.k0s(),t.j41(7,"span"),t.EFF(8),t.k0s()(),t.j41(9,"div",6)(10,"div",7)(11,"div",8)(12,"h5"),t.EFF(13,"Applicant Details"),t.k0s(),t.j41(14,"p")(15,"strong"),t.EFF(16,"Name:"),t.k0s(),t.EFF(17),t.k0s(),t.j41(18,"p")(19,"strong"),t.EFF(20,"Email:"),t.k0s(),t.EFF(21),t.k0s(),t.j41(22,"p")(23,"strong"),t.EFF(24,"Loan Amount:"),t.k0s(),t.EFF(25),t.nI1(26,"currency"),t.k0s(),t.j41(27,"p")(28,"strong"),t.EFF(29,"Purpose:"),t.k0s(),t.EFF(30),t.k0s()(),t.j41(31,"div",8)(32,"h5"),t.EFF(33,"Application Status"),t.k0s(),t.j41(34,"p")(35,"strong"),t.EFF(36,"Created:"),t.k0s(),t.EFF(37),t.nI1(38,"date"),t.k0s(),t.j41(39,"p")(40,"strong"),t.EFF(41,"Last Updated:"),t.k0s(),t.EFF(42),t.nI1(43,"date"),t.k0s(),t.j41(44,"p")(45,"strong"),t.EFF(46,"Assigned Underwriter:"),t.k0s(),t.EFF(47),t.k0s(),t.j41(48,"p")(49,"strong"),t.EFF(50,"Assigned Risk Analyst:"),t.k0s(),t.EFF(51),t.k0s()()(),t.j41(52,"div",9)(53,"h5"),t.EFF(54,"Documents"),t.k0s(),t.j41(55,"div",10),t.DNE(56,E,8,1,"div",11)(57,F,2,0,"div",12),t.k0s()(),t.j41(58,"div",9)(59,"h5"),t.EFF(60,"Comments"),t.k0s(),t.j41(61,"div",10),t.DNE(62,g,9,6,"div",11),t.k0s()(),t.DNE(63,R,12,1,"form",13),t.k0s()()(),t.j41(64,"div",14)(65,"div",4)(66,"div",15)(67,"h5"),t.EFF(68,"Review Timeline"),t.k0s()(),t.j41(69,"div",6)(70,"div",16),t.DNE(71,f,10,7,"div",17),t.k0s()()()()()()),2&i){const e=t.XpG();t.R7$(6),t.SpI("Review Application ",e.application.id,""),t.R7$(),t.HbH("badge "+e.getStatusClass(e.application.status)),t.R7$(),t.SpI(" ",e.application.status," "),t.R7$(9),t.SpI(" ",e.application.applicantName,""),t.R7$(4),t.SpI(" ",e.application.applicantEmail,""),t.R7$(4),t.SpI(" ",t.bMT(26,17,e.application.loanAmount),""),t.R7$(5),t.SpI(" ",e.application.purpose,""),t.R7$(7),t.SpI(" ",t.bMT(38,19,e.application.createdAt),""),t.R7$(5),t.SpI(" ",t.bMT(43,21,e.application.updatedAt),""),t.R7$(5),t.SpI(" ",e.application.assignedUnderwriter||"Not assigned",""),t.R7$(4),t.SpI(" ",e.application.assignedRiskAnalyst||"Not assigned",""),t.R7$(5),t.Y8G("ngForOf",e.application.documents),t.R7$(),t.Y8G("ngIf",0===e.application.documents.length),t.R7$(5),t.Y8G("ngForOf",e.application.comments),t.R7$(),t.Y8G("ngIf",e.canReview),t.R7$(8),t.Y8G("ngForOf",e.reviewTimeline)}}let b=(()=>{class i{constructor(e,n,o,l,k){this.route=e,this.router=n,this.formBuilder=o,this.loanService=l,this.authService=k,this.application=null,this.canReview=!1,this.LoanStatus=u.X,this.reviewTimeline=[],this.reviewForm=this.formBuilder.group({comment:[""]})}ngOnInit(){const e=this.route.snapshot.paramMap.get("id");e&&this.loadApplication(e),this.checkReviewPermissions()}loadApplication(e){this.loanService.getApplicationById(e).subscribe({next:n=>{n?(this.application=n,this.loadReviewTimeline()):this.router.navigate(["/applications"])},error:n=>{console.error("Error loading application:",n),this.router.navigate(["/applications"])}})}checkReviewPermissions(){const e=this.authService.currentUserValue;e&&(this.canReview=[p.g.UNDERWRITER,p.g.RISK_ANALYST,p.g.COMPLIANCE_OFFICER,p.g.MANAGER,p.g.SENIOR_MANAGER].includes(e.role))}loadReviewTimeline(){this.reviewTimeline=[{status:"Application Submitted",comment:"Initial application submission",date:new Date(2024,0,1),user:"System"},{status:"Under Review",comment:"Application assigned to underwriter",date:new Date(2024,0,2),user:"John Smith"}]}getStatusClass(e){return{DRAFT:"bg-secondary",SUBMITTED:"bg-primary",UNDER_REVIEW:"bg-warning",PENDING_DOCUMENTS:"bg-info",APPROVED:"bg-success",REJECTED:"bg-danger"}[e]||"bg-secondary"}updateStatus(e){if(!this.application)return;const n=this.reviewForm.get("comment")?.value,o={status:e,comments:[...this.application.comments,{id:`COM${Date.now()}`,text:n,author:this.authService.currentUserValue?.username||"Unknown",createdAt:new Date}]};this.loanService.updateApplication(this.application.id,o).subscribe({next:l=>{this.application=l,this.reviewForm.reset()},error:l=>{console.error("Error updating application:",l)}})}onSubmit(){this.reviewForm.valid&&this.application&&this.updateStatus(this.application.status)}static{this.\u0275fac=function(n){return new(n||i)(t.rXU(d.nX),t.rXU(d.Ix),t.rXU(a.ok),t.rXU(_.a),t.rXU(v.u))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-loan-review"]],standalone:!0,features:[t.aNF],decls:1,vars:1,consts:[["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row"],[1,"col-md-8"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"card-body"],[1,"row","mb-4"],[1,"col-md-6"],[1,"mb-4"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],["class","list-group-item text-center",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"col-md-4"],[1,"card-header"],[1,"timeline"],["class","timeline-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"d-flex","justify-content-between","align-items-center"],[1,"bi","bi-file-earmark-text","me-2"],[1,"btn","btn-sm","btn-primary"],[1,"bi","bi-download"],[1,"list-group-item","text-center"],[1,"d-flex","justify-content-between"],[1,"mb-0"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["formControlName","comment","rows","3",1,"form-control"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],[1,"timeline-item"],[1,"timeline-marker"],[1,"timeline-content"]],template:function(n,o){1&n&&t.DNE(0,h,72,23,"div",0),2&n&&t.Y8G("ngIf",o.application)},dependencies:[c.MD,c.Sq,c.bT,c.oe,c.vh,a.X1,a.qT,a.me,a.BC,a.cb,a.j4,a.JD],styles:['.timeline[_ngcontent-%COMP%]{position:relative;padding:20px 0}.timeline-item[_ngcontent-%COMP%]{position:relative;padding-left:30px;margin-bottom:20px}.timeline-marker[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:12px;height:12px;border-radius:50%;background:var(--primary-color);border:2px solid #fff}.timeline-item[_ngcontent-%COMP%]:before{content:"";position:absolute;left:5px;top:12px;bottom:-20px;width:2px;background:#e9ecef}.timeline-item[_ngcontent-%COMP%]:last-child:before{display:none}']})}}return i})()}}]);